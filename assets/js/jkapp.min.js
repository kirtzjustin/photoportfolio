let app;require(["esri/config","esri/portal/Portal","esri/WebMap","esri/WebScene","esri/Ground","esri/views/MapView","esri/views/SceneView","esri/layers/SceneLayer","esri/widgets/Search","esri/widgets/BasemapGallery","esri/widgets/BasemapToggle","esri/widgets/LayerList","esri/widgets/CoordinateConversion","esri/widgets/Home","esri/widgets/Print","esri/widgets/Legend","esri/widgets/Track","esri/widgets/ScaleBar","esri/widgets/Bookmarks","esri/widgets/Expand","esri/widgets/Popup","esri/widgets/Editor","esri/widgets/FeatureTable","esri/core/watchUtils","esri/layers/ElevationLayer","esri/layers/BaseElevationLayer","dojo/query","esri/geometry/support/webMercatorUtils","esri/geometry/SpatialReference","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/Polygon","esri/widgets/CoordinateConversion/support/Conversion","esri/widgets/CoordinateConversion/support/Format","esri/geometry/geometryEngine","esri/renderers/UniqueValueRenderer","esri/symbols/SimpleFillSymbol","esri/Graphic","esri/layers/GraphicsLayer","esri/widgets/DirectLineMeasurement3D","esri/widgets/AreaMeasurement3D","esri/widgets/DistanceMeasurement2D","esri/widgets/AreaMeasurement2D","esri/widgets/Sketch/SketchViewModel","esri/widgets/Sketch","esri/tasks/Locator","esri/tasks/GeometryService","esri/tasks/support/ProjectParameters","calcite-maps/calcitemaps-v0.8","calcite-maps/calcitemaps-arcgis-support-v0.8","bootstrap/Collapse","bootstrap/Dropdown","bootstrap/Tab","dojo/domReady!"],function(e,t,a,i,o,p,n,r,l,s,u,c,d,y,g,m,h,v,w,b,f,S,M,V,B,L,q,k,E,T,W,x,P,C,I,D,F,A,O,R,_,G,H,N,z,Q,j,U,Z,X){function Y(){app.bookmarksWidgetListItem=document.getElementById("bookmarksWidgetListItem"),app.bookmarksWidget3dWarningText=document.getElementsByClassName("esri-bookmarks__loader-container"),app.extentIndicator=document.getElementById("extentIndicator"),app.measureWidgetButtons2D=document.getElementById("measureWidgetButtons2D"),app.measureWidgetButtons3D=document.getElementById("measureWidgetButtons3D"),app.pointStyles=document.getElementById("sketchWidgetStylesPoint"),app.polylineStyles=document.getElementById("sketchWidgetStylesPolyline"),app.polygonStyles=document.getElementById("sketchWidgetStylesPolygon"),app.pointSymbolButtonColor=document.getElementById("colorSelectPoint"),app.pointSymbolButtonOpacity=document.getElementById("colorSelectPointAlpha"),app.pointSymbolButtonStyle=document.getElementById("pointStyleSelect"),app.pointSymbolButtonSize=document.getElementById("pointSizeSelect"),app.pointSymbolButtonOutlineColor=document.getElementById("outlineColorSelectPoint"),app.pointSymbolButtonOutlineColorOpacity=document.getElementById("outlineColorSelectPointAlpha"),app.pointSymbolButtonOutlineWidth=document.getElementById("outlineWidthSelectPoint"),app.polylineSymbolButtonColor=document.getElementById("colorSelectPolyline"),app.polylineSymbolButtonOpacity=document.getElementById("colorSelectPolylineAlpha"),app.polylineSymbolButtonStyle=document.getElementById("polylineStyleSelect"),app.polylineSymbolButtonWidth=document.getElementById("polylineWidthSelect"),app.polygonSymbolButtonColor=document.getElementById("colorSelectPolygon"),app.polygonSymbolButtonOpacity=document.getElementById("colorSelectPolygonAlpha"),app.polygonSymbolButtonStyle=document.getElementById("polygonStyleSelect"),app.polygonSymbolButtonOutlineColor=document.getElementById("outlineColorSelectPolygon"),app.polygonSymbolButtonOutlineColorOpacity=document.getElementById("outlineColorSelectPolygonAlpha"),app.polygonSymbolButtonOutlineWidth=document.getElementById("polygonOutlineWidthSelect"),app.printWidgetDiv=document.getElementById("printWidgetDiv"),app.chartDiv=document.getElementById("chartDiv"),app.queryingIndicatorContainer=document.getElementById("queryingIndicatorContainer"),app.queryMeasureContainerArea=document.getElementById("queryMeasureContainerArea"),app.queryMeasureContainerRadius=document.getElementById("queryMeasureContainerRadius"),app.queryTools=document.getElementById("queryTools"),app.clearHighlightedFeatures=document.getElementById("clearHighlightedFeatures"),app.zoomToExtentOfQueryPoly=document.getElementById("zoomToExtentOfQueryPoly"),app.mapViewNav=document.getElementById("mapViewNav"),app.sceneViewNav=document.getElementById("sceneViewNav"),app.screenshot3DButton=document.getElementById("screenshot3DButton"),app.screenshot3DSection=document.getElementById("screenshot3DSection"),app.screenshot3DDiv=document.getElementById("screenshot3DDiv"),app.overviewMapToggleBox=document.getElementById("overviewMapToggleBox"),app.elevationToggleDiv=document.getElementById("elevationToggleDiv"),app.clusterDiv=document.getElementById("clusterDiv"),app.elevationToggle=document.getElementById("elevationToggle"),app.filterToolSelectMenu=document.getElementById("filterToolSelectMenu"),app.filterToolSelectMenuLabel=document.getElementById("filterToolSelectMenuLabel"),app.coordinateConversionWarningText=document.getElementById("coordConversionWarning"),app.attributeTableLayerSelect=document.getElementById("layerSelectMenu")}function J(e,t){try{if("main"===t)return app.activeView.map.allLayers.find(function(t){return t.title===e});if("overview"===t)return app.overviewMapView.map.allLayers.find(function(t){return t.title===e});console.log('Error, please enter either "main" or "overview"')}catch(e){console.log("Error message findLayerByTitle: ",e.message)}}function K(e){return queryLayerViewStats(e).then(function(e){updateCharts(e,"canvasCount")})}function ee(e){let t=[],a=e.features,i=a[0].layer.title,o=e.fields[0].name,p=a.map(function(e){return e.attributes[app.filterToolField]});return p.forEach(function(e){(t.length<1||-1===t.indexOf(e))&&""!==e&&t.push(e)}),t.push(""),app.filterToolSelectMenuLabel.innerHTML="Filter <i>"+i+"</i> By <i>"+o+"</i>",t}function te(e){let t;if(app.filterToolSelectMenu.options.length>0)for(t=app.filterToolSelectMenu.options.length-1;t>=0;t--)app.filterToolSelectMenu.remove(t);return e.sort(),e.forEach(function(e){let t=document.createElement("option");""===e?(t.text="No Filter",t.value="",app.filterToolSelectMenu.add(t)):(t.text=e,app.filterToolSelectMenu.add(t))}),ae(app.filterToolSelectMenu.value)}function ae(e){if(""===e)app.filterToolLayer.definitionExpression=null,app.filterToolLayerOverviewMap.definitionExpression=null;else try{app.filterToolLayer.definitionExpression=app.filterToolField+" = '"+e+"'",app.filterToolLayerOverviewMap.definitionExpression=app.filterToolField+" = '"+e+"'"}catch(e){console.log("Error message setFilterLayerDefinitionExpression: ",e.message)}}function ie(e){let t,a,i;V.whenOnce(app.activeView,"ready").then(function(o){"3d"===app.activeView.type?e.style.visibility="hidden":"2d"===app.activeView.type&&0===app.activeView.rotation?("hidden"===e.style.visibility&&(e.style.visibility="visible"),t=app.activeView.extent,a=app.overviewMapView.toScreen(new T({x:t.xmin,y:t.ymin,spatialReference:t.spatialReference})),i=app.overviewMapView.toScreen(new T({x:t.xmax,y:t.ymax,spatialReference:t.spatialReference})),e.style.top=i.y+"px",e.style.left=a.x+"px",e.style.height=a.y-i.y+"px",e.style.width=i.x-a.x+"px"):"2d"===app.activeView.type&&"hidden"===e.style.visibility&&(e.style.visibility="visible")})}function oe(){V.whenOnce(app.activeView,"ready").then(function(e){"2d"===app.activeView.type?app.overviewMapView.goTo({center:app.activeView.center,scale:2*app.activeView.scale*Math.max(app.activeView.width/app.overviewMapView.width,app.activeView.height/app.overviewMapView.height),rotation:app.activeView.rotation},{duration:200,easing:"ease-out"}):app.overviewMapSceneView.goTo({center:app.activeView.center,heading:app.activeView.camera.heading,tilt:app.activeView.camera.tilt,scale:2.35*app.activeView.scale*Math.max(app.activeView.width/app.overviewMapSceneView.width,app.activeView.height/app.overviewMapSceneView.height)},{duration:750,easing:"ease-out"})})}function pe(){app.ipadPro125Landscape=window.matchMedia("only screen and (min-device-width: 1366px) and (max-device-width: 1366px) and (orientation: landscape) and (-webkit-min-device-pixel-ratio: 2)"),app.ipadPro125Portrait=window.matchMedia("only screen and (min-device-width: 1024px) and (max-device-width: 1024px) and (orientation: portrait) and (-webkit-min-device-pixel-ratio: 2)"),app.ipadPro105Landscape=window.matchMedia("only screen and (min-device-width: 1112px) and (max-device-width: 1112px) and (orientation: landscape) and (-webkit-min-device-pixel-ratio: 2)"),app.ipadPro105Portrait=window.matchMedia("only screen and (min-device-width: 834px) and (max-device-width: 834px) and (orientation: portrait) and (-webkit-min-device-pixel-ratio: 2)"),app.ipad3497=window.matchMedia("only screen and (min-device-width: 768px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2)"),app.ipad12MiniAir=window.matchMedia("only screen and (min-device-width: 768px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 1)"),app.smartPhonesPortrait=window.matchMedia("(min-width: 320px) and (max-width: 480px)"),app.smartPhonesLandscape=window.matchMedia("(min-width: 481px) and (max-width: 767px)"),app.smartPhonesPortrait.matches||app.smartPhonesLandscape.matches||app.ipadPro125Landscape.matches||app.ipadPro125Portrait.matches||app.ipadPro105Landscape.matches||app.ipadPro105Portrait.matches||app.ipad3497.matches||app.ipad12MiniAir.matches?console.log("On phone"):(console.log("On desktop"),$("#overviewMap").is(":hidden")&&$("#overviewMap").show())}function ne(e){let t,a;switch(e){case"distance":app.measureWidget2D=new G({viewModel:{view:app.activeView}}),null===app.measureWidget2D.view&&(app.measureWidget2D.view=app.activeView),t=document.createElement("div"),app.measureWidget2D.container=t,document.getElementById("measureOutput2D").appendChild(t),re(document.getElementById("drawPolygon"));break;case"area":app.measureWidget2D=new H({viewModel:{view:app.activeView}}),a=document.createElement("div"),app.measureWidget2D.container=a,document.getElementById("measureOutput2D").appendChild(a);break;case null:app.measureWidget2D&&(app.activeView.ui.remove(app.measureWidget2D),app.measureWidget2D.destroy())}}function re(e){app.activeView.focus();let t,a=document.getElementsByClassName("active");for(t=0;t<a.length;t++)"drawPolygon"===a[t].id?a[t].classList.remove("active"):"drawPolyline"===a[t].id&&a[t].classList.remove("active");e&&e.classList.add("active")}function le(){let e=document.getElementById("drawPolyline");e.removeEventListener("click",app.eventListener2DMeasureWidgetDistance),app.eventListener2DMeasureWidgetDistance=function(){return ne(null),this.classList.contains("active")?re(null):ne("distance")},e.addEventListener("click",app.eventListener2DMeasureWidgetDistance)}function se(){let e=document.getElementById("drawPolygon");e.removeEventListener("click",app.eventListener2DMeasureWidgetArea),app.eventListener2DMeasureWidgetArea=function(){ne(null),this.classList.contains("active")?re(null):ne("area")},e.addEventListener("click",app.eventListener2DMeasureWidgetArea)}function ue(e){let t,a;switch(e){case"distance":app.measureWidget3D=new R({view:app.activeView,unit:"imperial"}),null===app.measureWidget3D.view&&(app.measureWidget3D.view=app.activeView),t=document.createElement("div"),app.measureWidget3D.container=t,document.getElementById("measureOutput3D").appendChild(t),ce(document.getElementById("distanceButton"));break;case"area":app.measureWidget3D=new _({view:app.activeView,unit:"imperial"}),a=document.createElement("div"),app.measureWidget3D.container=a,document.getElementById("measureOutput3D").appendChild(a),ce(document.getElementById("areaButton"));break;case null:app.measureWidget3D&&(app.activeView.ui.remove(app.measureWidget3D),app.measureWidget3D.destroy())}}function ce(e){app.activeView.focus();let t,a=document.getElementsByClassName("active");for(t=0;t<a.length;t++)"areaButton"===a[t].id?a[t].classList.remove("active"):"distanceButton"===a[t].id&&a[t].classList.remove("active");e&&e.classList.add("active")}function de(){let e=document.getElementById("distanceButton");e.removeEventListener("click",app.eventListener3DMeasureWidgetDistance),app.eventListener3DMeasureWidgetDistance=function(){return ue(null),this.classList.contains("active")?ce(null):ue("distance")},e.addEventListener("click",app.eventListener3DMeasureWidgetDistance)}function ye(){let e=document.getElementById("areaButton");e.removeEventListener("click",app.eventListener3DMeasureWidgetArea),app.eventListener3DMeasureWidgetArea=function(){ue(null),this.classList.contains("active")?ce(null):ue("area")},e.addEventListener("click",app.eventListener3DMeasureWidgetArea)}function ge(e,t){let a;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return a=e.substring(1).split(""),3==a.length&&(a=[a[0],a[0],a[1],a[1],a[2],a[2]]),a="0x"+a.join(""),"rgba("+[a>>16&255,a>>8&255,255&a].join(",")+","+t+")";throw new Error("Bad Hex")}function me(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function he(e){app.screenshot3DDiv.classList.remove("hidden");let t=document.getElementsByClassName("js-screenshot-image")[0];t.width=.65*e.data.width,t.height=.65*e.data.height,t.src=e.dataUrl}function ve(e,t){let a=e.data,i=document.createElement("canvas"),o=i.getContext("2d");return i.height=a.height,i.width=a.width,o.putImageData(a,0,0),o.font="20px Arial",o.fillStyle="#000",o.fillRect(0,a.height-40,o.measureText(t).width+20,30),o.fillStyle="#fff",o.fillText(t,10,a.height-20),i.toDataURL()}function we(e,t){let a,i,o,p,n,r,l,s,u;if(window.navigator.msSaveOrOpenBlob){for(n=atob(t.split(",")[1]),r=t.split(",")[0].split(":")[1].split(";")[0],l=new ArrayBuffer(n.length),s=new Uint8Array(l),a=0;a<n.length;a++)s[a]=n.charCodeAt(a);u=new Blob([l],{type:r}),window.navigator.msSaveOrOpenBlob(u,e)}else i=document.createElement("a"),o=be(t),p=URL.createObjectURL(o),i.href=p,i.download=e,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}function be(e){let t,a,i,o,p;for(a=atob(e.split(",")[1]),i=a.length,o=new Uint8Array(i),p=e.split(",")[0].split(":")[1].split(";")[0],t=0;t<i;t++)o[t]=a.charCodeAt(t);return new Blob([o],{type:p})}function fe(e){app.map.ground.layers.forEach(function(t){t.visible=e.target.checked})}function Se(e,t){let a=e.viewpoint.clone();e.container=null,"3d"===e.type?t.container=app.containerMap:t.container=app.containerScene,t.viewpoint=a,t.padding=app.viewPadding}function Me(e){app.searchWidgetNav.view=e,app.searchWidgetNav.selectedResult&&V.whenTrueOnce(e,"ready",function(){app.searchWidgetNav.autoSelect=!1,app.searchWidgetNav.search(app.searchWidgetNav.selectedResult.name),app.searchWidgetNav.autoSelect=!0})}function Ve(e){app.activeView=e}app={basemap:"satellite",viewPadding:{top:40,bottom:0},uiPadding:{top:15,bottom:15},map:null,overviewMap:null,overviewMapView:null,overviewMapSceneView:null,overviewMapBasemapToggle:null,overviewMapBasemapToggleSceneView:null,overviewMapScaleBar:null,extentIndicator:null,overviewMapToggleBox:null,mapView:null,sceneView:null,activeView:null,mapViewNav:null,sceneViewNav:null,searchWidgetNav:null,containerMap:"mapViewDiv",containerScene:"sceneViewDiv",home:null,defaultHomeViewPoint:null,track:null,scaleBar:null,basemapGallery:null,legend:null,layerList:null,bookmarksWidget:null,bookmarksWidgetListItem:null,addCustomBookmark:null,bookmarksWidget3dWarningText:null,bookmarkCounter:1,coordinateConversion:null,newCoordFormat:null,coordinateConversionSearchPattern:/-?\d+[\.]?\d*/,measureWidget2D:null,measureWidget3D:null,eventListener2DMeasureWidgetDistance:null,eventListener2DMeasureWidgetArea:null,eventListener3DMeasureWidgetDistance:null,eventListener3DMeasureWidgetArea:null,measureWidgetButtons2D:null,measureWidgetButtons3D:null,sketchWidget:null,sketchWidgetGraphicsLayer:null,sketchWidgetSketchViewModel:null,sketchWidgetPointSymbol:null,sketchWidgetPolylineSymbol:null,sketchWidgetPolygonSymbol:null,pointStyles:null,polylineStyles:null,polygonStyles:null,pointSymbolButtonColor:null,pointSymbolButtonOpacity:null,pointSymbolButtonStyle:null,pointSymbolButtonSize:null,pointSymbolButtonOutlineColor:null,pointSymbolButtonOutlineColorOpacity:null,pointSymbolButtonOutlineWidth:null,polylineSymbolButtonColor:null,polylineSymbolButtonOpacity:null,polylineSymbolButtonStyle:null,polylineSymbolButtonWidth:null,polygonSymbolButtonColor:null,polygonSymbolButtonOpacity:null,polygonSymbolButtonStyle:null,polygonSymbolButtonOutlineColor:null,polygonSymbolButtonOutlineColorOpacity:null,polygonSymbolButtonOutlineWidth:null,pointSymbolButtonColorValue:null,pointSymbolButtonStyleValue:null,pointSymbolButtonSizeValue:null,pointSymbolButtonOutlineColorValue:null,pointSymbolButtonOutlineWidthValue:null,polylineSymbolButtonColorValue:null,polylineSymbolButtonStyleValue:null,polylineSymbolButtonWidthValue:null,polygonSymbolButtonColorValue:null,polygonSymbolButtonStyleValue:null,polygonSymbolButtonOutlineColorValue:null,polygonSymbolButtonOutlineWidthValue:null,printWidget:null,printWidgetDiv:null,selectedTableFeature:null,queryGraphicsLayer:null,querySketchWidget:null,queryPoint:null,queryPolyline:null,queryPolygon:null,querySketchViewModel:null,queryLayer:null,queryLayerView:null,queryTools:null,activeQueryPolygonButton:null,highlightedFeature:null,statsTable:null,queryMeasureArea:null,queryMeasureRadius:null,queryMeasureContainerArea:null,queryMeasureContainerRadius:null,queryingIndicatorContainer:null,clearHighlightedFeatures:null,zoomToExtentOfQueryPoly:null,squaredSymbol:"2".sup(),chartCount:null,bookmarksWidgetListItem:null,screenshot3DButton:null,screenshotBtn11X17:null,screenshot3DSection:null,screenshot3DDiv:null,smartPhonesPortrait:null,smartPhonesLandscape:null,ipadPro125Landscape:null,ipadPro125Portrait:null,ipadPro105Landscape:null,ipadPro105Portrait:null,ipad3497:null,ipad12MiniAir:null,elevationToggleDiv:null,elevationToggle:null,filterToolLayer:null,filterToolLayerOverviewMap:null,filterToolSelectMenu:null,filterToolSelectMenuLabel:null,filterToolField:null,coordinateConversionWarningText:null,clusterPointLayer:null,clusterPointLayerOverview:null,clusterPointLayer_clusterSettings:null,clusterDiv:null,attributeTableLayerSelect:null,attributeTable:null,attributeTableLayer:null,attributeTableFieldConfig:[],highlights:[]},app.sketchWidgetGraphicsLayer=new O({id:"sketchWidgetGraphicsLayer"}),app.sketchWidgetGraphicsLayer.listMode="hide",app.queryGraphicsLayer=new O,app.queryGraphicsLayer.listMode="hide",app.selectedTableFeature=new A({symbol:{type:"simple-marker",style:"square",color:[255,255,255,0],size:"16px",outline:{color:"red",width:2}}}),app.map=new a({portalItem:{id:"701743de5dfe42f5aa4fd06e185eb322"},layers:[app.sketchWidgetGraphicsLayer,app.queryGraphicsLayer]}),app.overviewMap=new a({portalItem:{id:"957e0ef0d5bc45eeae43e148434e1bfe"}}),app.overviewMap.popup=null,app.overviewMapView=new p({container:"overviewMap",map:app.overviewMap,constraints:{rotationEnabled:!1},ui:{components:["compass"],padding:app.uiPadding}}),app.overviewMapSceneView=new n({container:null,map:app.overviewMap,ui:{components:["compass"],padding:app.uiPadding}}),app.overviewMapBasemapToggle=new u({view:app.overviewMapView,nextBasemap:"streets"}),app.overviewMapBasemapToggleSceneView=new u({view:app.overviewMapSceneView,nextBasemap:"streets"}),app.overviewMapView.ui.add(app.overviewMapBasemapToggle,"top-right"),app.overviewMapScaleBar=new v({view:app.overviewMapView,style:"ruler"}),app.overviewMapView.ui.add(app.overviewMapScaleBar,"bottom-left"),app.mapView=new p({container:app.containerMap,map:app.map,padding:app.viewPadding,ui:{components:["zoom","compass","attribution"],padding:app.uiPadding},popup:{dockEnabled:!0,dockOptions:{position:"bottom-right",breakpoint:{width:600,height:1e3}}}}),app.sceneView=new n({container:null,map:app.map,padding:app.viewPadding,ui:{padding:app.uiPadding},popup:{dockEnabled:!0,dockOptions:{position:"bottom-right",breakpoint:{width:600,height:1e3}}}}),Ve(app.mapView),app.searchWidgetNav=new l({container:"searchNavDiv",view:app.activeView}),app.newCoordFormat=new C({name:"SC STATE PLANE",conversionInfo:{spatialReference:new E({wkid:102733}),reverseConvert:function(e,t){let a=e.split(",");return new T({x:parseFloat(a[0]),y:parseFloat(a[1]),spatialReference:{wkid:102733}})}},coordinateSegments:[{alias:"X",description:"easting",searchPattern:app.coordinateConversionSearchPattern},{alias:"Y",description:"northing",searchPattern:app.coordinateConversionSearchPattern}],defaultPattern:"X, Y"}),app.sketchWidgetPointSymbol={type:"simple-marker",style:"circle",color:"rgb(0,120,140)",size:"12px",outline:{color:[29,17,96],width:1}},app.sketchWidgetPolylineSymbol={type:"simple-line",color:"rgb(0,133,202)",width:"5",style:"solid"},app.sketchWidgetPolygonSymbol={type:"simple-fill",color:"rgba(187, 0, 0, 0.65)",style:"solid",outline:{color:[102,102,102],width:1}},app.home=new y({}),app.track=new h({}),app.scaleBar=new v({style:"ruler"}),app.basemapGallery=new s({container:"basemapGallery"}),app.legend=new m({container:"legendDiv",style:"classic"}),app.layerList=new c({container:"layerListDiv"}),app.bookmarksWidget=new w({container:"bookmarksDiv"}),app.coordinateConversion=new d({container:"coordinateConversionDiv"}),app.sketchWidgetSketchViewModel=new N({layer:app.sketchWidgetGraphicsLayer,pointSymbol:app.sketchWidgetPointSymbol,polylineSymbol:app.sketchWidgetPolylineSymbol,polygonSymbol:app.sketchWidgetPolygonSymbol}),app.sketchWidget=new z({container:"sketchWidgetButtons",id:"sketchWidget",viewModel:app.sketchWidgetSketchViewModel}),app.printWidget=new g({printServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task"}),app.querySketchWidget=new z({}),app.queryPoint={type:"simple-marker",style:"circle",color:"rgb(23, 43, 94)",size:"8px",outline:{color:[0,138,80],width:1}},app.queryPolyline={type:"simple-line",color:"red",width:"3.5",style:"dash"},app.queryPolygon={type:"simple-fill",color:"rgba(51, 51, 51, 0.5)",style:"solid",outline:{color:"red",width:3.5}},V.whenOnce(app.activeView,"ready").then(function(){Y(),app.mapViewNav.style.pointerEvents="none",app.home.view=app.activeView,app.track.view=app.activeView,app.scaleBar.view=app.activeView,app.sketchWidgetSketchViewModel.view=app.activeView,app.sketchWidget.view=app.activeView,app.printWidget.view=app.activeView,app.activeView.ui.add([{component:app.home,position:"top-left"},{component:app.track,position:"top-left"},{component:app.scaleBar,position:"bottom-left"}]),app.basemapGallery.view=app.activeView,app.basemapGallery.watch("activeBasemap",function(e){try{"Imagery with Labels"===e.title||"Imagery"===e.title||"Imagery Hybrid"===e.title?(app.overviewMap.basemap="streets",app.overviewMapBasemapToggle.nextBasemap="hybrid"):(app.overviewMap.basemap="hybrid",app.overviewMapBasemapToggle.nextBasemap="streets")}catch(e){console.log("Error message: ",e.message)}}),app.legend.view=app.activeView,app.bookmarksWidget.view=app.activeView,app.bookmarksWidget.editingEnabled=!0,app.coordinateConversion.view=app.activeView,app.coordinateConversion.formats.add(app.newCoordFormat),app.coordinateConversion.conversions.splice(0,0,new P({format:app.newCoordFormat})),app.coordinateConversion.watch("mode",function(e,t,a,i){"capture"===e?(app.activeView.popup=null,app.coordinateConversionWarningText.classList.remove("hidden")):(app.coordinateConversionWarningText.classList.add("hidden"),app.activeView.popup=new f({dockEnabled:!0,dockOptions:{position:"bottom-right",breakpoint:{width:600,height:1e3}}}))}),app.layerList.view=app.activeView,app.layerList.listItemCreatedFunction=function(e){let t=e.item;t.view=app.activeView,t.panel||(t.panel={content:"legend",open:!1}),t.actionsSections=[[{title:"Increase Layer Opacity",className:"esri-icon-up",id:"increase-opacity"},{title:"Decrease Layer Opacity",className:"esri-icon-down",id:"decrease-opacity"},{title:"Zoom To Layer's Full Extent",className:"esri-icon-zoom-out-fixed",id:"full-extent"}]]},app.layerList.on("trigger-action",function(e){let t=e.item.layer,a=e.action.id;if("increase-opacity"===a)t.opacity<1&&(t.opacity+=.25);else if("decrease-opacity"===a)t.opacity>0&&(t.opacity-=.25);else if("full-extent"===a)if(t.fullExtent.spatialReference!==app.activeView.spatialReference){var i=new j({url:"http://sampleserver6.arcgisonline.com/arcgis/rest/services/Utilities/Geometry/GeometryServer"}),o=new U({geometries:[t.fullExtent],outSpatialReference:app.activeView.spatialReference});i.project(o).then(function(e){app.activeView.goTo(e[0])})}else app.activeView.goTo(t.fullExtent)}),app.defaultHomeViewPoint=(()=>app.mapView.viewpoint.clone())(),app.printWidget.container=app.printWidgetDiv,le(),se(),V.when(app.sketchWidget,"activeTool",function(){let e,t,a,i,o;switch(app.pointSymbolButtonColorValue=ge(app.pointSymbolButtonColor.value,app.pointSymbolButtonOpacity.value),app.pointSymbolButtonStyleValue=app.pointSymbolButtonStyle.options[app.pointSymbolButtonStyle.selectedIndex].value,app.pointSymbolButtonSizeValue=app.pointSymbolButtonSize.options[app.pointSymbolButtonSize.selectedIndex].value,app.pointSymbolButtonOutlineColorValue=ge(app.pointSymbolButtonOutlineColor.value,app.pointSymbolButtonOutlineColorOpacity.value),app.pointSymbolButtonOutlineWidthValue=parseInt(app.pointSymbolButtonOutlineWidth.options[app.pointSymbolButtonOutlineWidth.selectedIndex].value),app.polylineSymbolButtonColorValue=ge(app.polylineSymbolButtonColor.value,app.polylineSymbolButtonOpacity.value),app.polylineSymbolButtonStyleValue=app.polylineSymbolButtonStyle.options[app.polylineSymbolButtonStyle.selectedIndex].value,app.polylineSymbolButtonWidthValue=parseInt(app.polylineSymbolButtonWidth.options[app.polylineSymbolButtonWidth.selectedIndex].value),app.polygonSymbolButtonColorValue=ge(app.polygonSymbolButtonColor.value,app.polygonSymbolButtonOpacity.value),app.polygonSymbolButtonStyleValue=app.polygonSymbolButtonStyle.options[app.polygonSymbolButtonStyle.selectedIndex].value,app.polygonSymbolButtonOutlineColorValue=ge(app.polygonSymbolButtonOutlineColor.value,app.polygonSymbolButtonOutlineColorOpacity.value),app.polygonSymbolButtonOutlineWidthValue=parseInt(app.polygonSymbolButtonOutlineWidth.options[app.polygonSymbolButtonOutlineWidth.selectedIndex].value),app.sketchWidget.activeTool){case"point":e=app.sketchWidget.viewModel.pointSymbol.clone(),e.color=app.pointSymbolButtonColorValue,e.outline.color=app.pointSymbolButtonOutlineColorValue,e.style=app.pointSymbolButtonStyleValue,e.size=app.pointSymbolButtonSizeValue,e.outline.width=app.pointSymbolButtonOutlineWidthValue,app.sketchWidget.viewModel.pointSymbol=e,app.pointStyles.classList.remove("hidden"),app.polylineStyles.classList.add("hidden"),app.polygonStyles.classList.add("hidden");break;case"polyline":t=app.sketchWidget.viewModel.polylineSymbol.clone(),t.color=app.polylineSymbolButtonColorValue,t.style=app.polylineSymbolButtonStyleValue,t.width=app.polylineSymbolButtonWidthValue,app.sketchWidget.viewModel.polylineSymbol=t,app.pointStyles.classList.add("hidden"),app.polylineStyles.classList.remove("hidden"),app.polygonStyles.classList.add("hidden");break;case"polygon":a=app.sketchWidget.viewModel.polygonSymbol.clone(),a.color=app.polygonSymbolButtonColorValue,a.outline.color=app.polygonSymbolButtonOutlineColorValue,a.style=app.polygonSymbolButtonStyleValue,a.outline.width=app.polygonSymbolButtonOutlineWidthValue,app.sketchWidget.viewModel.polygonSymbol=a,app.pointStyles.classList.add("hidden"),app.polylineStyles.classList.add("hidden"),app.polygonStyles.classList.remove("hidden");break;case"rectangle":i=app.sketchWidget.viewModel.polygonSymbol.clone(),i.color=app.polygonSymbolButtonColorValue,i.outline.color=app.polygonSymbolButtonOutlineColorValue,i.style=app.polygonSymbolButtonStyleValue,i.outline.width=app.polygonSymbolButtonOutlineWidthValue,app.sketchWidget.viewModel.polygonSymbol=i,app.pointStyles.classList.add("hidden"),app.polylineStyles.classList.add("hidden"),app.polygonStyles.classList.remove("hidden");break;case"circle":o=app.sketchWidget.viewModel.polygonSymbol.clone(),o.color=app.polygonSymbolButtonColorValue,o.outline.color=app.polygonSymbolButtonOutlineColorValue,o.style=app.polygonSymbolButtonStyleValue,o.outline.width=app.polygonSymbolButtonOutlineWidthValue,app.sketchWidget.viewModel.polygonSymbol=o,app.pointStyles.classList.add("hidden"),app.polylineStyles.classList.add("hidden"),app.polygonStyles.classList.remove("hidden")}}),app.map.layers.reorder(app.queryGraphicsLayer,app.map.layers.items.length-1),app.map.layers.reorder(app.sketchWidget_graphicsLayer,app.map.layers.items.length),app.querySketchViewModel=new N({view:app.activeView,layer:app.queryGraphicsLayer,polygonSymbol:app.queryPolygon,pointSymbol:app.queryPoint,polylineSymbol:app.queryPolyline}),app.querySketchWidget.view=app.activeView,app.querySketchWidget.viewModel=app.querySketchViewModel,app.querySketchWidget.container="geometryQueryButtons",app.querySketchWidget.id="geometryquerybuttons_sketchWidget",app.queryLayer=J("My Travel Locations","main"),app.queryLayer.outFields=["*"],app.activeView.whenLayerView(app.queryLayer).then(function(e){app.queryLayerView=e,app.querySketchWidget.on("create",function(t){try{app.queryPolygon=t.graphic.geometry,app.activeQueryPolygonButton=t.tool}catch(e){console.log("stats widget error message: ",e.message)}if("active"===t.state){try{app.queryGraphicsLayer.removeAll(),app.highlightedFeature&&app.highlightedFeature.remove(),app.statsTable.clearData()}catch(e){console.log("querySketchWidget error: ",e.message)}if(app.queryMeasureArea=I.geodesicArea(app.queryPolygon,"square-feet"),app.queryMeasureArea<0){let e=I.simplify(app.queryPolygon);e&&(app.queryMeasureArea=I.geodesicArea(e,"square-feet"))}"circle"===t.tool?app.queryMeasureRadius=Math.sqrt(app.queryMeasureArea/Math.PI):app.queryMeasureRadius=0,app.queryMeasureContainerArea.innerHTML=me(app.queryMeasureArea.toFixed(2))+" ft"+app.squaredSymbol,app.queryMeasureContainerRadius.innerHTML=me(app.queryMeasureRadius.toFixed(2))+" ft"}else"complete"===t.state&&(app.queryingIndicatorContainer.classList.remove("noVisibility"),K(app.queryPolygon),app.queryLayer.queryFeatures({geometry:app.queryPolygon,outFields:["*"],outSpatialReference:app.activeView.spatialReference,returnGeometry:!0}).then(function(t){let a=t.features;app.highlightedFeature&&app.highlightedFeature.remove(),app.highlightedFeature=e.highlight(a),app.activeView.goTo(app.queryPolygon.extent.expand(2))}))}),app.querySketchWidget.on("update",function(t){let a=t.graphics[0].geometry;if("start"===t.state&&null===t.toolEventInfo)app.activeView.popup=null,app.activeView.popup=new f({dockEnabled:!0,dockOptions:{position:"bottom-right",breakpoint:{width:600,height:1e3}}});else if("active"!==t.state||"scale"!==t.toolEventInfo.type&&"reshape"!==t.toolEventInfo.type)if("active"!==t.state||"move-stop"!==t.toolEventInfo.type&&"scale-stop"!==t.toolEventInfo.type&&"reshape-stop"!==t.toolEventInfo.type&&"rotate-stop"!==t.toolEventInfo.type){if("aborted"===t.state||"complete"===t.state)try{app.activeView.popup=new f({dockEnabled:!0,dockOptions:{position:"bottom-right",breakpoint:{width:600,height:1e3}}})}catch(e){console.log("Error recreating popup: ",e.message)}}else app.queryingIndicatorContainer.classList.remove("noVisibility"),K(a),app.queryLayer.queryFeatures({geometry:a,outFields:["*"],outSpatialReference:app.activeView.spatialReference,returnGeometry:!0}).then(function(t){let i=t.features;app.highlightedFeature&&app.highlightedFeature.remove(),app.highlightedFeature=e.highlight(i),app.activeView.goTo(a.extent.expand(2))});else{if(app.queryMeasureArea=I.geodesicArea(a,"square-feet"),app.queryMeasureArea<0){let e=I.simplify(a);e&&(app.queryMeasureArea=I.geodesicArea(e,"square-feet"))}"circle"===app.activeQueryPolygonButton?app.queryMeasureRadius=Math.sqrt(app.queryMeasureArea/Math.PI):app.queryMeasureRadius=0,app.queryMeasureContainerArea.innerHTML=me(app.queryMeasureArea.toFixed(2))+" ft"+app.squaredSymbol,
app.queryMeasureContainerRadius.innerHTML=me(app.queryMeasureRadius.toFixed(2))+" ft"}})}),app.clearHighlightedFeatures.addEventListener("click",function(){try{app.queryGraphicsLayer.removeAll(),app.highlightedFeature.remove(),app.statsTable.clearData(),app.queryPolygon=null}catch(e){console.log("clearHighlightedFeatures Error: ",e.message)}}),app.zoomToExtentOfQueryPoly.addEventListener("click",function(){try{app.activeView.goTo(app.queryPolygon.extent)}catch(e){console.log("zoomToExtentOfQueryPoly error: ",e.message)}}),app.filterToolLayer=J("My Favorite Photos","main"),app.filterToolLayerOverviewMap=J("My Favorite Photos","overview"),app.filterToolField="takenwith",app.filterToolLayer.when(function(){let e=app.filterToolLayer.createQuery();return e.outFields=[app.filterToolField],app.filterToolLayer.queryFeatures(e)}).then(ee).then(te),app.filterToolSelectMenu.addEventListener("change",function(){let e=event.target.value;ae(e)}),app.clusterPointLayer=J("My Travel Locations","main"),app.clusterPointLayerOverview=J("My Travel Locations","overview"),app.clusterPointLayer_clusterSettings={type:"cluster",clusterRadius:"20",popupTemplate:{title:"Cluster of {cluster_count} "+app.clusterPointLayer.title,content:"Cluster represents {cluster_count} "+app.clusterPointLayer.title}};for(let e=0;e<app.activeView.map.layers.items.length;e++)if("feature"===app.activeView.map.layers.items[e].type){let t=document.createElement("option");t.text=app.activeView.map.layers.items[e].title,t.value=app.activeView.map.layers.items[e].title,app.attributeTableLayerSelect.add(t)}let e=document.createElement("option");e.text="",e.value="",e.selected=!0,app.attributeTableLayerSelect.add(e),app.attributeTableLayerSelect.addEventListener("change",function(){let e=event.target.value;app.attributeTableLayer=J(e,"main");try{app.attributeTableFieldConfig.length>0&&(app.attributeTableFieldConfig=[]);for(let e=0;e<app.attributeTableLayer.fields.length;e++)app.attributeTableFieldConfig.push({name:app.attributeTableLayer.fields[e].name,label:app.attributeTableLayer.fields[e].name});if(app.attributeTable){app.attributeTable.destroy();let e=document.getElementById("attributeTablePanelBody"),t=document.createElement("div");t.id="attributeTable",e.appendChild(t)}if(app.attributeTable=new M({layer:app.attributeTableLayer,fieldConfigs:app.attributeTableFieldConfig,container:document.getElementById("attributeTable")}),0===$(".esri-feature-table__menu-accordion #zoomTo").length){let e=document.getElementsByClassName("esri-feature-table__menu-accordion").item(0),t=document.createElement("li"),a=document.createElement("button"),i=document.createElement("span");t.id="zoomTo",t.classList.add("esri-feature-table__menu-item"),t.setAttribute("role","menuitem"),a.classList.add("esri-feature-table__button","esri-feature-table__menu-item-label"),a.id="zoomToButton",i.classList.add("esri-feature-table__menu-item-label__content"),i.innerHTML="Zoom To Selected Feature",a.appendChild(i),t.appendChild(a),e.appendChild(t)}app.activeView.whenLayerView(app.attributeTableLayer).then(function(e){function t(){const e=app.attributeTableLayer.createQuery(),t=app.highlights.map(function(e){return e.feature.getAttribute(app.attributeTableLayer.objectIdField)});e.objectIds=t,e.returnGeometry=!0,app.attributeTableLayer.queryFeatures(e).then(function(e){app.activeView.goTo(e.features).catch(function(e){"AbortError"!=e.name&&console.error(e)})})}app.attributeTable.on("selection-change",function(t){t.removed.forEach(function(e){const t=app.highlights.find(function(t){return t.feature===e.feature});t&&(app.highlights.splice(app.highlights.indexOf(t),1),t.highlight.remove())}),t.added.forEach(function(t){const a=t.feature;highlight=e.highlight(t.feature),app.highlights.push({feature:a,highlight:highlight})})}),document.getElementById("zoomToButton").addEventListener("click",t)})}catch(e){console.log("Error Message: Attribute Table: ",e.mesage)}})}).then(function(){app.activeView.watch("extent",()=>ie(app.extentIndicator)),app.overviewMapView.watch("extent",()=>ie(app.extentIndicator))}).then(function(){V.when(app.activeView,"stationary",oe)}),X.setSearchExpandEvents(app.searchWidgetNav),X.setPopupPanelSync(app.mapView),X.setPopupPanelSync(app.sceneView),q(".calcite-navbar li a[data-toggle='tab']").on("click",function(e){if(e.target.text.indexOf("2D")>-1){app.mapViewNav.style.pointerEvents="none",app.sceneViewNav.style.pointerEvents="auto",app.map.ground=new o({}),app.overviewMap.ground=new o({}),app.overviewMapSceneView.container=null,app.overviewMapView.container="overviewMap",app.overviewMapView.popup=null,app.overviewMapBasemapToggle.view=app.overviewMapView,app.overviewMapView.ui.add(app.overviewMapBasemapToggle,"top-right");try{app.measureWidget3D.viewModel.clearMeasurement(),app.activeView.ui.remove(app.measureWidget3D),app.measureWidget3D.destroy(),app.measureWidget3D=null}catch(e){console.log("3D Measurement Widget Error Message: ",e.message)}if(app.sketchWidget.updateGraphics.items.length>0)try{app.sketchWidget.cancel()}catch(e){console.log("Sketch Widget Error Message: ",e.message)}app.overviewMapToggleBox.checked||(app.overviewMapToggleBox.checked="checked"),pe(),Se(app.sceneView,app.mapView),Ve(app.mapView),V.whenOnce(app.activeView,"ready").then(function(){app.home.view=app.activeView,app.home.viewpoint=app.defaultHomeViewPoint,app.track.view=app.activeView,app.scaleBar.view=app.activeView,app.basemapGallery.view=app.activeView,app.legend.view=app.activeView,app.layerList.view=app.activeView,app.bookmarksWidget.view=app.activeView,app.coordinateConversion.view=app.activeView,app.sketchWidget.view=app.activeView,app.querySketchWidget.view=app.activeView,app.bookmarksWidgetListItem.classList.remove("hidden"),app.measureWidgetButtons2D.classList.remove("hidden"),app.measureWidgetButtons3D.classList.add("hidden"),app.screenshot3DSection.classList.add("hidden"),app.bookmarkCounter=1,app.printWidgetDiv.classList.remove("hidden"),app.elevationToggleDiv.classList.add("hidden"),app.clusterDiv.classList.remove("hidden"),app.queryLayer=J("My Travel Locations","main"),app.queryLayer.outFields=["*"];try{app.statsTable.clearData()}catch(e){console.log("clear stats table Error: ",e.message)}if(app.activeView.whenLayerView(app.queryLayer).then(function(e){app.queryLayerView=e,app.querySketchWidget.on("create",function(t){try{app.queryPolygon=t.graphic.geometry,app.activeQueryPolygonButton=t.tool}catch(e){console.log("stats widget error message: ",e.message)}if("active"===t.state){try{app.queryGraphicsLayer.removeAll(),app.highlightedFeature&&app.highlightedFeature.remove(),app.statsTable.clearData()}catch(e){console.log("querySketchWidget error: ",e.message)}if(app.queryMeasureArea=I.geodesicArea(app.queryPolygon,"square-feet"),app.queryMeasureArea<0){let e=I.simplify(app.queryPolygon);e&&(app.queryMeasureArea=I.geodesicArea(e,"square-feet"))}"circle"===t.tool?app.queryMeasureRadius=Math.sqrt(app.queryMeasureArea/Math.PI):app.queryMeasureRadius=0,app.queryMeasureContainerArea.innerHTML=me(app.queryMeasureArea.toFixed(2))+" ft"+app.squaredSymbol,app.queryMeasureContainerRadius.innerHTML=me(app.queryMeasureRadius.toFixed(2))+" ft"}else"complete"===t.state&&(app.queryingIndicatorContainer.classList.remove("noVisibility"),K(app.queryPolygon),app.queryLayer.queryFeatures({geometry:app.queryPolygon,outFields:["*"],outSpatialReference:app.activeView.spatialReference,returnGeometry:!0}).then(function(t){let a=t.features;app.highlightedFeature&&app.highlightedFeature.remove(),app.highlightedFeature=e.highlight(a),app.activeView.goTo(app.queryPolygon.extent.expand(2))}))}),app.querySketchWidget.on("update",function(t){let a=t.graphics[0].geometry;if("start"===t.state&&null===t.toolEventInfo)app.activeView.popup=null,app.activeView.popup=new f({dockEnabled:!0,dockOptions:{position:"bottom-right",breakpoint:{width:600,height:1e3}}});else if("active"!==t.state||"scale"!==t.toolEventInfo.type&&"reshape"!==t.toolEventInfo.type)if("active"!==t.state||"move-stop"!==t.toolEventInfo.type&&"scale-stop"!==t.toolEventInfo.type&&"reshape-stop"!==t.toolEventInfo.type&&"rotate-stop"!==t.toolEventInfo.type){if("aborted"===t.state||"complete"===t.state)try{app.activeView.popup=new f({dockEnabled:!0,dockOptions:{position:"bottom-right",breakpoint:{width:600,height:1e3}}})}catch(e){console.log("Error recreating popup: ",e.message)}}else app.queryingIndicatorContainer.classList.remove("noVisibility"),K(a),app.queryLayer.queryFeatures({geometry:a,outFields:["*"],outSpatialReference:app.activeView.spatialReference,returnGeometry:!0}).then(function(t){let i=t.features;app.highlightedFeature&&app.highlightedFeature.remove(),app.highlightedFeature=e.highlight(i),app.activeView.goTo(a.extent.expand(2))});else{if(app.queryMeasureArea=I.geodesicArea(a,"square-feet"),app.queryMeasureArea<0){let e=I.simplify(a);e&&(app.queryMeasureArea=I.geodesicArea(e,"square-feet"))}"circle"===app.activeQueryPolygonButton?app.queryMeasureRadius=Math.sqrt(app.queryMeasureArea/Math.PI):app.queryMeasureRadius=0,app.queryMeasureContainerArea.innerHTML=me(app.queryMeasureArea.toFixed(2))+" ft"+app.squaredSymbol,app.queryMeasureContainerRadius.innerHTML=me(app.queryMeasureRadius.toFixed(2))+" ft"}})}),app.activeView.whenLayerView(app.queryLayer).then(function(e){app.queryLayerView=e,app.querySketchWidget.on("create",function(t){try{app.queryPolygon=t.graphic.geometry,app.activeQueryPolygonButton=t.tool}catch(e){console.log("stats widget error message: ",e.message)}if("active"===t.state){try{app.queryGraphicsLayer.removeAll(),app.highlightedFeature&&app.highlightedFeature.remove(),app.statsTable.clearData()}catch(e){console.log("querySketchWidget error: ",e.message)}if(app.queryMeasureArea=I.geodesicArea(app.queryPolygon,"square-feet"),app.queryMeasureArea<0){let e=I.simplify(app.queryPolygon);e&&(app.queryMeasureArea=I.geodesicArea(e,"square-feet"))}"circle"===t.tool?app.queryMeasureRadius=Math.sqrt(app.queryMeasureArea/Math.PI):app.queryMeasureRadius=0,app.queryMeasureContainerArea.innerHTML=me(app.queryMeasureArea.toFixed(2))+" ft"+app.squaredSymbol,app.queryMeasureContainerRadius.innerHTML=me(app.queryMeasureRadius.toFixed(2))+" ft"}else"complete"===t.state&&(app.queryingIndicatorContainer.classList.remove("noVisibility"),K(app.queryPolygon),app.queryLayer.queryFeatures({geometry:app.queryPolygon,outFields:["*"],outSpatialReference:app.activeView.spatialReference,returnGeometry:!0}).then(function(t){let a=t.features;app.highlightedFeature&&app.highlightedFeature.remove(),app.highlightedFeature=e.highlight(a),app.activeView.goTo(app.queryPolygon.extent.expand(2))}))}),app.querySketchWidget.on("update",function(t){let a=t.graphics[0].geometry;if("start"===t.state&&null===t.toolEventInfo)app.activeView.popup=null,app.activeView.popup=new f({dockEnabled:!0,dockOptions:{position:"bottom-right",breakpoint:{width:600,height:1e3}}});else if("active"!==t.state||"scale"!==t.toolEventInfo.type&&"reshape"!==t.toolEventInfo.type)if("active"!==t.state||"move-stop"!==t.toolEventInfo.type&&"scale-stop"!==t.toolEventInfo.type&&"reshape-stop"!==t.toolEventInfo.type&&"rotate-stop"!==t.toolEventInfo.type){if("aborted"===t.state||"complete"===t.state)try{app.activeView.popup=new f({dockEnabled:!0,dockOptions:{position:"bottom-right",breakpoint:{width:600,height:1e3}}})}catch(e){console.log("Error recreating popup: ",e.message)}}else app.queryingIndicatorContainer.classList.remove("noVisibility"),K(a),app.queryLayer.queryFeatures({geometry:a,outFields:["*"],outSpatialReference:app.activeView.spatialReference,returnGeometry:!0}).then(function(t){let i=t.features;app.highlightedFeature&&app.highlightedFeature.remove(),app.highlightedFeature=e.highlight(i),app.activeView.goTo(a.extent.expand(2))});else{if(app.queryMeasureArea=I.geodesicArea(a,"square-feet"),app.queryMeasureArea<0){let e=I.simplify(a);e&&(app.queryMeasureArea=I.geodesicArea(e,"square-feet"))}"circle"===app.activeQueryPolygonButton?app.queryMeasureRadius=Math.sqrt(app.queryMeasureArea/Math.PI):app.queryMeasureRadius=0,app.queryMeasureContainerArea.innerHTML=me(app.queryMeasureArea.toFixed(2))+" ft"+app.squaredSymbol,app.queryMeasureContainerRadius.innerHTML=me(app.queryMeasureRadius.toFixed(2))+" ft"}})}),app.attributeTable){app.attributeTable.destroy();let e=document.getElementById("attributeTablePanelBody"),t=document.createElement("div");t.id="attributeTable",e.appendChild(t)}if(app.attributeTable=new M({layer:app.attributeTableLayer,fieldConfigs:app.attributeTableFieldConfig,container:document.getElementById("attributeTable")}),0===$(".esri-feature-table__menu-accordion #zoomTo").length){let e=document.getElementsByClassName("esri-feature-table__menu-accordion").item(0),t=document.createElement("li"),a=document.createElement("button"),i=document.createElement("span");t.id="zoomTo",t.classList.add("esri-feature-table__menu-item"),t.setAttribute("role","menuitem"),a.classList.add("esri-feature-table__button","esri-feature-table__menu-item-label"),a.id="zoomToButton",i.classList.add("esri-feature-table__menu-item-label__content"),i.innerHTML="Zoom To Selected Feature",a.appendChild(i),t.appendChild(a),e.appendChild(t)}app.activeView.whenLayerView(app.attributeTableLayer).then(function(e){function t(){const e=app.attributeTableLayer.createQuery(),t=app.highlights.map(function(e){return e.feature.getAttribute(app.attributeTableLayer.objectIdField)});e.objectIds=t,e.returnGeometry=!0,app.attributeTableLayer.queryFeatures(e).then(function(e){app.activeView.goTo(e.features).catch(function(e){"AbortError"!=e.name&&console.error(e)})})}app.attributeTable.on("selection-change",function(t){t.removed.forEach(function(e){const t=app.highlights.find(function(t){return t.feature===e.feature});t&&(app.highlights.splice(app.highlights.indexOf(t),1),t.highlight.remove())}),t.added.forEach(function(t){const a=t.feature;highlight=e.highlight(t.feature),app.highlights.push({feature:a,highlight:highlight})})}),document.getElementById("zoomToButton").addEventListener("click",t)})}).then(function(){app.activeView.watch("extent",()=>ie(app.extentIndicator)),app.overviewMapView.watch("extent",()=>ie(app.extentIndicator))}).then(function(){V.when(app.activeView,"stationary",oe)})}else{app.mapViewNav.style.pointerEvents="auto",app.sceneViewNav.style.pointerEvents="none",app.overviewMap.ground="world-elevation",app.overviewMapView.container=null,app.overviewMapSceneView.container="overviewMap",app.overviewMapSceneView.popup=null,app.overviewMapBasemapToggle.view=app.overviewMapSceneView,app.overviewMapSceneView.ui.add(app.overviewMapBasemapToggle,"top-right"),app.map.ground="world-elevation";try{app.measureWidget2D.viewModel.clearMeasurement(),app.activeView.ui.remove(app.measureWidget2D),app.measureWidget2D.destroy(),app.measureWidget2D=null}catch(e){console.log("2D Measurement Widget Error Message: ",e.message)}if(app.sketchWidget.updateGraphics.items.length>0)try{app.sketchWidget.cancel()}catch(e){console.log("Sketch Widget Error Message: ",e.message)}else if(app.querySketchWidget.updateGraphics.items.length>0)try{app.querySketchWidget.cancel()}catch(e){console.log("stats widget - sketch widget update error: ",e.message)}app.overviewMapToggleBox.checked||(app.overviewMapToggleBox.checked="checked"),pe(),Se(app.mapView,app.sceneView),Ve(app.sceneView),app.queryGraphicsLayer.removeAll();try{app.chartCount.destroy()}catch(e){console.log("Chart Destroy Error Message: ",e.message)}app.chartCount=null,V.whenOnce(app.activeView,"ready").then(function(){if(app.home.view=app.activeView,app.home.viewpoint=app.defaultHomeViewPoint,app.track.view=app.activeView,app.scaleBar.view=app.activeView,app.basemapGallery.view=app.activeView,app.legend.view=app.activeView,app.layerList.view=app.activeView,app.coordinateConversion.view=app.activeView,app.sketchWidget.view=app.activeView,app.querySketchWidget.view=app.activeView,app.bookmarksWidget3dWarningText[0].innerHTML="<p>Bookmarks widget is not supported in 3D.</p>",app.bookmarksWidgetListItem.classList.add("hidden"),de(),ye(),app.measureWidgetButtons2D.classList.add("hidden"),app.measureWidgetButtons3D.classList.remove("hidden"),app.printWidgetDiv.classList.add("hidden"),app.elevationToggleDiv.classList.remove("hidden"),app.clusterDiv.classList.add("hidden"),app.attributeTable){app.attributeTable.destroy();let e=document.getElementById("attributeTablePanelBody"),t=document.createElement("div");t.id="attributeTable",e.appendChild(t)}if(app.attributeTable=new M({layer:app.attributeTableLayer,fieldConfigs:app.attributeTableFieldConfig,container:document.getElementById("attributeTable")}),0===$(".esri-feature-table__menu-accordion #zoomTo").length){let e=document.getElementsByClassName("esri-feature-table__menu-accordion").item(0),t=document.createElement("li"),a=document.createElement("button"),i=document.createElement("span");t.id="zoomTo",t.classList.add("esri-feature-table__menu-item"),t.setAttribute("role","menuitem"),a.classList.add("esri-feature-table__button","esri-feature-table__menu-item-label"),a.id="zoomToButton",i.classList.add("esri-feature-table__menu-item-label__content"),i.innerHTML="Zoom To Selected Feature",a.appendChild(i),t.appendChild(a),e.appendChild(t)}app.activeView.whenLayerView(app.attributeTableLayer).then(function(e){function t(){const e=app.attributeTableLayer.createQuery(),t=app.highlights.map(function(e){return e.feature.getAttribute(app.attributeTableLayer.objectIdField)});e.objectIds=t,e.returnGeometry=!0,app.attributeTableLayer.queryFeatures(e).then(function(e){app.activeView.goTo(e.features).catch(function(e){"AbortError"!=e.name&&console.error(e)})})}app.attributeTable.on("selection-change",function(t){t.removed.forEach(function(e){const t=app.highlights.find(function(t){return t.feature===e.feature});t&&(app.highlights.splice(app.highlights.indexOf(t),1),t.highlight.remove())}),t.added.forEach(function(t){const a=t.feature;highlight=e.highlight(t.feature),app.highlights.push({feature:a,highlight:highlight})})}),document.getElementById("zoomToButton").addEventListener("click",t)}),app.screenshot3DSection.classList.remove("hidden"),app.screenshot3DButton.addEventListener("click",function(){let e,t,a,i,o,p;app.screenshot3DButton.classList.add("active"),e=1532,t=992,a=app.activeView.padding,i=app.activeView.width-a.left-a.right,o=app.activeView.height-a.top-a.bottom,p={format:"png",area:{x:(i-e)/2,y:(o-t)/2,width:e,height:t}},app.activeView.takeScreenshot(p).then(function(e){he(e),document.getElementById("download3dScreenshotButton").onclick=function(){let t,a;t=document.getElementById("screenshot3ddiv_title").value,t?(a=ve(e,t),we(app.map.portalItem.title+".png",a)):we(app.map.portalItem.title+".png",e.dataUrl)},app.screenshot3DButton.classList.remove("active")})}),document.getElementById("close3dScreenshotButton").addEventListener("click",function(){app.screenshot3DDiv.classList.add("hidden")}),app.elevationToggle.addEventListener("change",fe),app.elevationToggle.checked||(app.elevationToggle.checked="checked"),app.activeView.whenLayerView(app.queryLayer).then(function(e){app.queryLayerView=e,app.querySketchWidget.on("create",function(t){try{app.queryPolygon=t.graphic.geometry,app.activeQueryPolygonButton=t.tool}catch(e){console.log("stats widget error message: ",e.message)}if("active"===t.state){try{app.queryGraphicsLayer.removeAll(),app.highlightedFeature&&app.highlightedFeature.remove(),app.statsTable.clearData()}catch(e){console.log("querySketchWidget error: ",e.message)}if(app.queryMeasureArea=I.geodesicArea(app.queryPolygon,"square-feet"),app.queryMeasureArea<0){let e=I.simplify(app.queryPolygon);e&&(app.queryMeasureArea=I.geodesicArea(e,"square-feet"))}"circle"===t.tool?app.queryMeasureRadius=Math.sqrt(app.queryMeasureArea/Math.PI):app.queryMeasureRadius=0,app.queryMeasureContainerArea.innerHTML=me(app.queryMeasureArea.toFixed(2))+" ft"+app.squaredSymbol,app.queryMeasureContainerRadius.innerHTML=me(app.queryMeasureRadius.toFixed(2))+" ft"}else"complete"===t.state&&(app.queryingIndicatorContainer.classList.remove("noVisibility"),K(app.queryPolygon),app.queryLayer.queryFeatures({geometry:app.queryPolygon,outFields:["*"],outSpatialReference:app.activeView.spatialReference,returnGeometry:!0}).then(function(t){let a=t.features;app.highlightedFeature&&app.highlightedFeature.remove(),app.highlightedFeature=e.highlight(a),app.activeView.goTo(app.queryPolygon.extent.expand(2))}))}),app.querySketchWidget.on("update",function(t){let a=t.graphics[0].geometry;if("start"===t.state&&null===t.toolEventInfo)app.activeView.popup=null,app.activeView.popup=new f({dockEnabled:!0,dockOptions:{position:"bottom-right",breakpoint:{width:600,height:1e3}}});else if("active"!==t.state||"scale"!==t.toolEventInfo.type&&"reshape"!==t.toolEventInfo.type)if("active"!==t.state||"move-stop"!==t.toolEventInfo.type&&"scale-stop"!==t.toolEventInfo.type&&"reshape-stop"!==t.toolEventInfo.type&&"rotate-stop"!==t.toolEventInfo.type){if("aborted"===t.state||"complete"===t.state)try{app.activeView.popup=new f({dockEnabled:!0,dockOptions:{position:"bottom-right",breakpoint:{width:600,height:1e3}}})}catch(e){console.log("Error recreating popup: ",e.message)}}else app.queryingIndicatorContainer.classList.remove("noVisibility"),K(a),app.queryLayer.queryFeatures({geometry:a,outFields:["*"],outSpatialReference:app.activeView.spatialReference,returnGeometry:!0}).then(function(t){let i=t.features;app.highlightedFeature&&app.highlightedFeature.remove(),app.highlightedFeature=e.highlight(i),app.activeView.goTo(a.extent.expand(2))});else{if(app.queryMeasureArea=I.geodesicArea(a,"square-feet"),app.queryMeasureArea<0){let e=I.simplify(a);e&&(app.queryMeasureArea=I.geodesicArea(e,"square-feet"))}"circle"===app.activeQueryPolygonButton?app.queryMeasureRadius=Math.sqrt(app.queryMeasureArea/Math.PI):app.queryMeasureRadius=0,app.queryMeasureContainerArea.innerHTML=me(app.queryMeasureArea.toFixed(2))+" ft"+app.squaredSymbol,app.queryMeasureContainerRadius.innerHTML=me(app.queryMeasureRadius.toFixed(2))+" ft"}})})}).then(function(){app.activeView.watch("extent",()=>ie(app.extentIndicator)),app.overviewMapView.watch("extent",()=>ie(app.extentIndicator))}).then(function(){V.when(app.activeView,"stationary",oe)})}app.activeView.ui.add(app.home,"top-left"),app.activeView.ui.add(app.track,"top-left"),app.activeView.ui.add(app.scaleBar,"bottom-left"),Me(app.activeView)}),q("#collapseTable").on("shown.bs.collapse",function(){try{null!==app.statsTable&&app.statsTable.redraw(!0)}catch(e){console.log("Error Message redraw table: ",e.message)}})});